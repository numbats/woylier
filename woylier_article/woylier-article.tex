% !TeX root = RJwrapper.tex
\title{Woylier: Alternative tour frame interpolation method}
\author{by Zoljargal Batsaikhan, Dianne Cook, Ursula Laa}

\maketitle

\abstract{%
The woylier package implements alternative method for interpolation path between tour frames using Givens rotation.
}

\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

The idea of projection pursuit is a procedure used to locate the projection of high-to-low dimensional space that expose the most interesting feature of data originally proposed by Kruskal(Kruskal 1969). The projection pursuit technique involves a criterion of interest, numerical objective function, and the most interesting projection of data is achieved when the criterion is maximized. In the literature, there are a number of such criterion has been developed based on clustering, spread, and outliers.

Grand tour is a multivariate data visualization technique developed by Asimov(Asimov 1985), which is based on idea of rotations of a lower dimensional projection in high-dimensional space. This technique is equivalent to rotating an object in 3D to better understand its shape and dimensions. Originally, Asimov's grand tour presents the viewer with an automatic movie of projections with no user control. Since then the literature on the tour has been about interactivity of the tour giving the control to users.(Buja et al. 2005) One of the interactive visual data exploration tool is ``guided tour''.

The guided tour gives user an extrapolation power by combining projection pursuit with tour which is implemented in the ``tourr''(Wickham et al. 2011) package. Current implementation of guided tour used geodesic interpolation between planes.

The interpolated paths based on geodesic interpolation between bases is visually invariant under changes of orientation. However, in some cases of non-linear projection pursuit the orientation of frames does matter. One example is splines2D index. This rotational variety issue of non-linear projection pursuit functions was the motivation of this work.

A few alternatives to geodesic interpolation were proposed by Buja et al(Buja et al. 2005). The purpose of woylier package is to implement Givens paths method. This algorithms adapts Given's matrix decomposition technique that zeros out all but first elements of a vector.

This article is structured as follows. The next section provided the theoretical framework of Givens interpolation method followed by a section about the implementation Givens path in woylier package that is compatible with current geodesic\_path() function of tourr package. Furthermore, we would attempt to apply this interpolation method to projection pursuit of splines index to search for nonlinear associations between variables in example data set. Finally, this article includes a discussion about the limitations.

\hypertarget{background}{%
\section{Background}\label{background}}

The tour method of visualization is animated high-to-low dimensional data rotation that is a movie, one-parameter (time) family of static projections. Several algorithms for such dynamic projections are discussed by Buja et al(Buja et al. 2005) is based on the idea of smoothly interpolating a discrete sequence of projections.

The topic of this paper is the construction of paths of projections. Interpolation of paths of projection can be compared to connecting line segments that interpolate points in Euclidean space. Interpolation acts as a bridge between continuous animation and discrete choice of sequences of projections. Sequence of projections can be constructed in various ways depending on user purpose. If user wants to look at the data from all sides, a random sequence of projections can be used, which is implemented in grand tours. Furthermore, the sequence of projections can be pre-computed, data-driven, or even manually controlled.

Before continuing with the interpolation algorithms, we need to define the notations.

\begin{itemize}
\tightlist
\item
  Let the p be the dimension of original data and d be the dimension onto which the data is being projected.
\item
  A frame F is defined as \(p\times d\) matrix with pairwise orthogonal columns of unit length that satisfies, where \(I_d\) is the identity matrix in d dimensions.
\end{itemize}

\[F^TF = I_d\]
- Paths of projections are given by continuous one-parameter families \(F(t)\) where \(t\in [a, z]\) interval representing time. We denote the starting frame by \(F_a = F(a)\) and target frame by \(F_z = F(z)\).

\textbf{Preprojection algorithm}

The purpose of preprojection is to limit the data subspace \(F_a\) and \(F_z\) that the interpolated path is traversing so that the interpolation is carried out simply. Simply, it is defining the joint subspace of \(F_a\) and \(F_z\).

The procedure starts with forming an arbitrary orthonormal basis by applying Gram-Schmidt to \(F_z\) with regard to \(F_a\). We denote the resulting orthonormal basis of \(p\times d_s\) by \(B\).

Now, we can express the original frames in this basis:

\[F_a = BW_a, F_z = BW_z\]

The interpolation problem is then reduced to the construction of paths of frames \(W(t)\) that interpolate the projected frames \(W_a\) and \(W_z\).

\textbf{The interpolating paths of plane versus frames}

The interpolation of frames is required when the orientation of projection matters. If the rendering on a frame and on the rotated version of the frame yields the same visual scenes, it means the orientation does not matter.

Current implementation of tourr package(Wickham et al. 2011) is locally shortest (geodesic) interpolation of planes. The pitfall of this interpolation method is that it does not account for rotation variability.

The orientation of frames could be important when non-linear projection pursuit function is used in guided tour. An illustration of such cases are shown below.

\textbf{Givens transformation}

A rotation matrix is a transformation matrix that is used to perform a rotation in Euclidean space in xy plane. A rotation matrix that transforms 2-D plane by an angle \(\theta\) looks like this:

\[ \begin{bmatrix}\cos \theta &-\sin \theta \\\sin \theta &\cos \theta \end{bmatrix} \]

If the rotation is in the plane of variables i and j, it is called Givens rotation.

The interpolation methods in this project are based on the composition of a number of Givens rotations that maps starting frame onto the target frame.

\[ W_z = R_m(\tau_m) ... R_2(\tau_2)R_1(\tau_1)W_a\]

\textbf{Givens interpolation path algorithm}

Frame interpolation is necessary when the orientation of the projection matters. There are several methods discussed in the paper including decomposition of orthogonal matrices, givens decomposition and householder decomposition. One that is of interest to us is Givens path.

The usage of Givens rotations comes from the fact that in any vector u one can zero out the i'th coordinate with a Givens rotation in the (i; j)-plane for any j \$ \neq \$ i. This rotation affects only coordinates i and j andleaves all coordinates k \(\neq\) i; j unchanged.

Sequences of Givens rotations can map any orthonormal d-frame F in p-space to standard d-frame \(E_d=((1, 0, 0, ...)^T, (0, 1, 0, ...)^T, ...)\).

The path construction algorithm work as follows:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Construct preprojection basis \(B\) by orthonormalizing \(F_z\) with regards tp \(F_a\) with Gram-Schmidt:
\end{enumerate}

\[B = (F_a, F_{\star})\].

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Get the preprojected frames
  \[W_a = B^TF_a = E_d\] and \[W_z = B^TF_z\]
\item
  Then we can construct a sequence of Givens rotation that maps \(W_z\) to \(W_a\):
\end{enumerate}

\[ W_a = R_m(\tau_m) ... R_2(\tau_2)R_1(\tau_1)W_z\] The inverse mapping is obtained by reversing the sequence of rotations with the negative of the angles:

\[R(\tau) = R_1(-\tau_1) ... R_m(-\tau_m), \    W_z = R(\tau)W_a\]

\hypertarget{introduction-1}{%
\section{Introduction}\label{introduction-1}}

Interactive data graphics provides plots that allow users to interact them. One of the most basic types of interaction is through tooltips, where users are provided additional information about elements in the plot by moving the cursor over the plot.

This paper will first review some R packages on interactive graphics and their tooltip implementations. A new package \CRANpkg{ToOoOlTiPs} that provides customized tooltips for plot, is introduced. Some example plots will then be given to showcase how these tooltips help users to better read the graphics.

\hypertarget{background-1}{%
\section{Background}\label{background-1}}

Some packages on interactive graphics include \CRANpkg{plotly} (Sievert 2020) that interfaces with Javascript for web-based interactive graphics, \CRANpkg{crosstalk} (Cheng and Sievert 2021) that specializes cross-linking elements across individual graphics. The recent R Journal paper \CRANpkg{tsibbletalk} (Wang and Cook 2021) provides a good example of including interactive graphics into an article for the journal. It has both a set of linked plots, and also an animated gif example, illustrating linking between time series plots and feature summaries.

\hypertarget{customizing-tooltip-design-with}{%
\section{\texorpdfstring{Customizing tooltip design with \pkg{ToOoOlTiPs}}{Customizing tooltip design with }}\label{customizing-tooltip-design-with}}

\pkg{ToOoOlTiPs} is a packages for customizing tooltips in interactive graphics, it features these possibilities.

\hypertarget{a-gallery-of-tooltips-examples}{%
\section{A gallery of tooltips examples}\label{a-gallery-of-tooltips-examples}}

The \CRANpkg{palmerpenguins} data (Horst, Hill, and Gorman 2020) features three penguin species which has a lovely illustration by Alison Horst in Figure @ref(fig:penguins-alison).

\begin{figure}
\includegraphics[width=1\linewidth,height=0.3\textheight]{penguins} \caption{Artwork by \@allison\_horst}(\#fig:penguins-alison)
\end{figure}

Table @ref(tab:penguins-tab-static) prints at the first few rows of the \texttt{penguins} data:

\begin{table}

\caption{(\#tab:penguins-tab-static)A basic table}
\centering
\fontsize{7}{9}\selectfont
\begin{tabular}[t]{l|l|r|r|r|r|l|r}
\hline
species & island & bill\_length\_mm & bill\_depth\_mm & flipper\_length\_mm & body\_mass\_g & sex & year\\
\hline
Adelie & Torgersen & 39.1 & 18.7 & 181 & 3750 & male & 2007\\
\hline
Adelie & Torgersen & 39.5 & 17.4 & 186 & 3800 & female & 2007\\
\hline
Adelie & Torgersen & 40.3 & 18.0 & 195 & 3250 & female & 2007\\
\hline
Adelie & Torgersen & NA & NA & NA & NA & NA & 2007\\
\hline
Adelie & Torgersen & 36.7 & 19.3 & 193 & 3450 & female & 2007\\
\hline
Adelie & Torgersen & 39.3 & 20.6 & 190 & 3650 & male & 2007\\
\hline
\end{tabular}
\end{table}

Figure @ref(fig:penguins-ggplot) shows an plot of the penguins data, made using the \CRANpkg{ggplot2} package.

\begin{verbatim}
penguins %>% 
  ggplot(aes(x = bill_depth_mm, y = bill_length_mm, 
             color = species)) + 
  geom_point()
\end{verbatim}

\begin{figure}
\centering
\includegraphics{woylier_article_files/figure-latex/penguins-ggplot-1.pdf}
\caption{(\#fig:penguins-ggplot)A basic non-interactive plot made with the ggplot2 package on palmer penguin data. Three species of penguins are plotted with bill depth on the x-axis and bill length on the y-axis. Visit the online article to access the interactive version made with the plotly package.}
\end{figure}

\hypertarget{summary}{%
\section{Summary}\label{summary}}

We have displayed various tooltips that are available in the package \pkg{ToOoOlTiPs}.

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-asimov_1985}{}}%
Asimov, D. 1985. {``The Grand Tour: A Tool for Viewing Multidimensional Data.''} \emph{SIAM J Sci Stat Comput 6(1)}, 128--43.

\leavevmode\vadjust pre{\hypertarget{ref-buja_cook_asimov_hurley_2005}{}}%
Buja, Andreas, Dianne Cook, Daniel Asimov, and Catherine Hurley. 2005. {``Computational Methods for High-Dimensional Rotations in Data Visualization.''} \emph{Handbook of Statistics}, 391--413. \url{https://doi.org/10.1016/s0169-7161(04)24014-7}.

\leavevmode\vadjust pre{\hypertarget{ref-crosstalk}{}}%
Cheng, Joe, and Carson Sievert. 2021. \emph{{crosstalk}: Inter-Widget Interactivity for HTML Widgets}. \url{https://CRAN.R-project.org/package=crosstalk}.

\leavevmode\vadjust pre{\hypertarget{ref-palmerpenguins}{}}%
Horst, Allison Marie, Alison Presmanes Hill, and Kristen B Gorman. 2020. \emph{{palmerpenguins}: Palmer Archipelago (Antarctica) Penguin Data}. \url{https://allisonhorst.github.io/palmerpenguins/}.

\leavevmode\vadjust pre{\hypertarget{ref-kruskal_1969}{}}%
Kruskal, JB. 1969. {``Toward a Practical Method Which Helps Uncover the Structure of a Set of Observations by Finding the Line Transformation Which Optimizes a New ``Index of Condensation.''} \emph{Statistical Computation; New York, Academic Press}, 427--40.

\leavevmode\vadjust pre{\hypertarget{ref-plotly}{}}%
Sievert, Carson. 2020. \emph{{Interactive Web-Based Data Visualizatio}n with r, Plotly, and Shiny}. Chapman; Hall/CRC. \url{https://plotly-r.com}.

\leavevmode\vadjust pre{\hypertarget{ref-RJ-2021-050}{}}%
Wang, Earo, and Dianne Cook. 2021. {``Conversations in Time: Interactive Visualisation to Explore Structured Temporal Data.''} \emph{The R Journal}. \url{https://doi.org/10.32614/RJ-2021-050}.

\leavevmode\vadjust pre{\hypertarget{ref-tourr}{}}%
Wickham, Hadley, Dianne Cook, Heike Hofmann, and Andreas Buja. 2011. {``{tourr}: An {R} Package for Exploring Multivariate Data with Projections.''} \emph{Journal of Statistical Software} 40 (2): 1--18. \url{https://doi.org/10.18637/jss.v040.i02}.

\end{CSLReferences}

\bibliography{RJreferences.bib}

\address{%
Zoljargal Batsaikhan\\
Monash University\\%
Department of Letter Q\\ Somewhere, Australia\\
%
\url{https://www.britannica.com/animal/quokka}\\%
\textit{ORCiD: \href{https://orcid.org/N/A}{N/A}}\\%
\href{mailto:zoljargal11@gmail.com}{\nolinkurl{zoljargal11@gmail.com}}%
}

\address{%
Dianne Cook\\
Monash University\\%
Department of Letter B\\ Somewhere, Australia\\
%
\url{https://www.britannica.com/animal/bilby}\\%
\textit{ORCiD: \href{https://orcid.org/0000-0002-3813-7155}{0000-0002-3813-7155}}\\%
\href{mailto:dicook@monash.edu}{\nolinkurl{dicook@monash.edu}}%
}

\address{%
Ursula Laa\\
BOKU University\\%
Department of Letter B\\ Somewhere, Australia\\
%
\url{https://www.britannica.com/animal/bilby}\\%
\textit{ORCiD: \href{https://orcid.org/0000-0002-0249-6439}{0000-0002-0249-6439}}\\%
\href{mailto:ursula.laa@boku.ac.at}{\nolinkurl{ursula.laa@boku.ac.at}}%
}
